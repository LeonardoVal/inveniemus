//! inveniemus 0.1.3-alpha

!function(a,b){"use strict";"function"==typeof define&&define.amd?define(["creatartis-base"],b):"object"==typeof module&&module.exports?module.exports=b(require("creatartis-base")):a.inveniemus=b(a.base)}(this,function a(b){"use strict";{var c=b.declare,d=b.initialize,e=b.iterable,f=b.raiseIf,g=b.Events,h=b.Future,i=b.Iterable,j=b.Logger,k=b.Randomness,l=b.Statistics,m={__package__:"inveniemus",__name__:"inveniemus",__init__:a,__dependencies__:[b],__SERMAT__:{include:[]},metaheuristics:{},problems:{}},n=m.metaheuristics,o=m.problems,p=m.Element=c({constructor:function(a,b,c){this.problem=a,this.values=b?b.map(function(a,b){return f(isNaN(a),"Value #",b," for element is NaN!"),Math.min(1,Math.max(0,+a))}):a.random.randoms(a.elementLength()),this.evaluation=+c},suffices:function(){return this.problem.sufficient(this)},emblem:function(){return JSON.stringify(this.mapping())},evaluate:function(){var a=this;return h.then(this.problem.evaluation(this),function(b){return a.evaluation=b,b})},resolution:1e-15,hammingDistance:function(a,b){return e(a).zip(b).filter(function(a){return a[0]!=a[1]}).count()},manhattanDistance:function(a,b){return e(a).zip(b).map(function(a){return Math.abs(a[0]-a[1])}).sum()},euclideanDistance:function(a,b){return Math.sqrt(e(a).zip(b).map(function(a){return Math.pow(a[0]-a[1],2)}).sum())},rootMeanSquaredError:function(a,b){var c=0,d=e(b).map(function(b){return c++,Math.pow(b[0]-a.apply(this,b.slice(1)),2)}).sum();return 0===c?0:Math.sqrt(d/c)},successors:function(){return this.neighbourhood()},neighbourhood:function(a){var b,c,d,e=[],f=this.values;for(b=0;b<f.length;b++)c="number"==typeof a?a:Array.isArray(a)?a[b]:.01,d=f[b]+c,1>=d&&e.push(this.modification(b,d)),d=f[b]-c,d>=0&&e.push(this.modification(b,d));return e},modification:function(){var a,b,c=this.values.slice();for(a=0;a<arguments.length;a+=2)b=+arguments[a+1],f(isNaN(b),"Invalid value ",b," for element."),c[0|arguments[a]]=Math.min(1,Math.max(0,b));return new this.constructor(this.problem,c)},mapping:function(){return this.problem.mapping(this)},arrayMapping:function(){var a=arguments,b=a[a.length-1];return f(a.length<1,"Element.arrayMapping() expects at least one argument."),this.values.map(function(c,d){var e=a.length>d?a[d]:b;return e[c*e.length|0]})},setMapping:function(a){return f(!Array.isArray(a),"Element.setMapping() expects an array argument."),a=a.slice(),this.values.map(function(b){return a.splice(b*a.length|0,1)[0]})},rangeMapping:function(){var a=arguments,b=a[a.length-1];return f(a.length<1,"Element.rangeMapping() expects at least one argument."),this.values.map(function(c,d){var e=a.length>d?a[d]:b;return c*(e[1]-e[0])+e[0]})},clone:function(){return new this.constructor(this.problem,this.values,this.evaluation)},equals:function(a){if(this.constructor===a.constructor&&this.values.length===a.values.length){for(var b=0,c=this.values.length;c>b;b++)if(this.values[b]!==a.values[b])return!1;return!0}return!1},toString:function(){return(this.constructor.name||"Element")+"("+JSON.stringify(this.values)+", "+this.evaluation+")"},"static __SERMAT__":{identifier:"Element",serializer:function(a){return[a.problem,a.values,a.evaluation]}}}),q=m.Problem=c({title:"<no title>",description:"<no description>",random:k.DEFAULT,constructor:function(a){d(this,a).string("title",{coerce:!0,ignore:!0}).string("description",{coerce:!0,ignore:!0}).object("random",{ignore:!0})},elementLength:function(){return 10},newElement:function(a,b){return new p(this,a,b)},evaluation:function(a){return e(a.values).sum()},mapping:function(a){return a.values},sufficientElement:function(){return!1},sufficientElements:function(a){return this.sufficientElement(a[0])},compare:function(a,b){return this.minimization(a,b)},maximization:function(a,b){var c=b.evaluation-a.evaluation;return isNaN(c)?-1/0:Math.abs(c)<a.resolution?0:c},minimization:function(a,b){var c=a.evaluation-b.evaluation;return isNaN(c)?1/0:Math.abs(c)<a.resolution?0:c},approximation:function(a,b,c){var d=Math.abs(b.evaluation-a)-Math.abs(c.evaluation-a);return isNaN(d)?1/0:Math.abs(d)<b.resolution?0:d},toString:function(){return(this.constructor.name||"Problem")+"("+JSON.stringify(this)+")"},"static __SERMAT__":{identifier:"Problem",serializer:function(a){return this.serializeAsProperties(a,["title","description","random"],!0)}}}),r=m.Metaheuristic=c({logger:new j("inveniemus",j.ROOT,"INFO"),constructor:function(a){d(this,a).object("problem",{defaultValue:null}).number("size",{defaultValue:100,coerce:!0}).array("state",{defaultValue:[]}).number("steps",{defaultValue:100,coerce:!0}).integer("step",{defaultValue:-1,coerce:!0}).object("random",{defaultValue:k.DEFAULT}).object("statistics",{defaultValue:new l}).object("logger",{ignore:!0}),this.events=new g({events:["initiated","updated","expanded","evaluated","sieved","advanced","analyzed","finished"]})},initiate:function(a){a=isNaN(a)?this.size:+a>>0,this.state=new Array(a);for(var b=0;a>b;b++)this.state[b]=this.problem.newElement();this.onInitiate()},update:function(){var a=this;return this.expand(),this.evaluate().then(function(){return a.sieve(),a.onUpdate(),a})},expand:function(a){if(a=a||this.expansion(),a.length<1)this.logger&&this.logger.warn("Expansion is empty");else{var b=this.state.concat(a),c=b.length;b=b.filter(function(a,d){for(d++;c>d;d++)if(a.equals(b[d]))return!1;return!0}),this.state=b}this.onExpand()},expansion:function(a){var b=isNaN(this.expansionRate)?.5:+this.expansionRate;a=isNaN(a)?Math.floor(b*this.size):+a;var c,d=new Array(a);for(c=0;a>c;c++)d[c]=this.problem.newElement();return d},evaluate:function(a){var b=this,c=this.statistics.stat({key:"evaluation_time"});return c.startTime(),a=a||this.state,h.all(e(a).filter(function(a){return isNaN(a.evaluation)},function(a){return h.when(a.evaluate())})).then(function(d){return a.sort(b.problem.compare.bind(b.problem)),c.addTime(),b.onEvaluate(d),a})},sieve:function(a){a=isNaN(a)?this.size:0|a,this.state.length>a&&(this.state=this.state.slice(0,this.size)),this.onSieve()},finished:function(){return this.step>=this.steps||this.problem.sufficientElements(this.state)},analyze:function(){var a=this.statistics.stat({key:"evaluation",step:this.step});return this.state.forEach(function(b){a.add(b.evaluation,b)}),this.onAnalyze(),a},advance:function(){var a,b=this,c=this.statistics.stat({key:"step_time"});return isNaN(this.step)||+this.step<0?(this.statistics.reset(),c.startTime(),this.initiate(),a=this.evaluate()):(c.startTime(),a=this.update()),a.then(function(){return b.step=isNaN(b.step)||+b.step<0?0:+b.step+1,b.analyze(),c.addTime(),b.onAdvance(),b})},run:function(){function a(){return!b.finished()}var b=this,c=this.advance.bind(this);return h.doWhile(c,a).then(function(){return b.onFinish(),b.state[0]})},reset:function(){this.step=-1,this.statistics.reset()},nub:function(a){return a=isNaN(a)?1e-15:+a,this.state=e(this.state).nub(function(b,c){var d=b.values,e=c.values,f=d.length;if(f!==c.values.length)return!1;for(var g=0;f>g;++g)if(Math.abs(d[g]-e[g])>a)return!1;return!0}).toArray(),this.state.length},onInitiate:function(){this.events.emit("initiated",this),this.logger&&this.logger.debug("State has been initiated. Nos coepimus.")},onUpdate:function(){this.events.emit("updated",this),this.logger&&this.logger.debug("State has been updated. Mutatis mutandis.")},onExpand:function(){this.events.emit("expanded",this),this.logger&&this.logger.debug("State has been expanded. Nos exploramus.")},onEvaluate:function(a){this.events.emit("evaluated",this),this.logger&&this.logger.debug("Evaluated and sorted ",a.length," elements. Appretiatus sunt.")},onSieve:function(){this.events.emit("sieved",this),this.logger&&this.logger.debug("State has been sieved. Haec est viam.")},onAdvance:function(){this.events.emit("advanced",this),this.logger&&this.logger.debug("Step ",this.step," has been completed. Nos proficimus.")},onAnalyze:function(){this.events.emit("analyzed",this),this.logger&&this.logger.debug("Statistics have been gathered. Haec sunt numeri.")},onFinish:function(){this.events.emit("finished",this),this.logger&&this.logger.debug("Finished. Nos invenerunt!")},toString:function(){return(this.constructor.name||"Metaheuristic")+"("+JSON.stringify(this)+")"},"static __SERMAT__":{identifier:"Metaheuristic",serializer:function(a){return this.serializeAsProperties(a,["problem","size","state","steps","step","random","statistics"])}}}),s=(n.HillClimbing=c(r,{constructor:function(a){r.call(this,a),d(this,a).number("delta",{defaultValue:.01,coerce:!0}).integer("size",{defaultValue:1,coerce:!0})},update:function(){var a=this,b=0;return h.all(this.state.map(function(c){var d=c.neighbourhood(a.delta);return d.push(c),a.evaluate(d).then(function(a){var d=a[0];return c===d&&b++,d})})).then(function(c){c.sort(a.problem.compare.bind(a.problem)),a.state=c,a.__localOptima__=b,a.onUpdate()})},atLocalOptima:function(){return this.__localOptima__>=this.state.length},finished:function(){return r.prototype.finished.call(this)||this.atLocalOptima()},toString:function(){return(this.constructor.name||"HillClimbing")+"("+JSON.stringify(this)+")"}}),n.GeneticAlgorithm=c(r,{constructor:function u(a){r.call(this,a),d(this,a).number("expansionRate",{defaultValue:.5,minimum:0,coerce:!0}).number("mutationRate",{defaultValue:.2,minimum:0,maximum:1,coerce:!0}).func("selection",{defaultValue:u.selections.rankSelection}).func("crossover",{defaultValue:u.crossovers.singlepointCrossover}).func("mutation",{defaultValue:u.mutations.singlepointUniformMutation})},expansion:function(){var a,b,c,d=[],e=Math.floor(this.expansionRate*this.size);e+=e%2;for(var f=0;e>f;f+=2){a=this.selection(),b=this.crossover(a);for(var g=0;g<b.length;g++)c=this.random.randomBool(this.mutationRate)?this.mutation(b[g]):b[g],d.push(c)}return this.onExpand(),d},"static selections":{rankSelection:function(a){a=isNaN(a)?2:+a;var b=this.state.length,c=this.random.randoms(a,0,b*(b+1)/2-1),d=[];return c.sort(function(a,b){return a-b}),this.state.forEach(function(e){for(var f=0;a>f;f++)c[f]+=f-b;c[0]<=0&&(d.push(e),c.shift())}),d.length<a&&(d=d.concat(this.state.slice(0,a-d.length))),d},rouletteSelection:function(a){a=isNaN(a)?2:0|a;var b=this.state.length,c=this.statistics.stat({key:"evaluation",step:this.step}),d=c.minimum(),e=c.sum(),f=this.random.randoms(a,0,e-b*d),g=[];return f.sort(function(a,b){return a-b}),this.state.forEach(function(c){for(var d=0;a>d;d++)f[d]+=d-b;f[0]<=0&&(g.push(c),f.shift())}),g.length<a&&(g=g.concat(this.state.slice(0,a-g.length))),g},stochasticUniversalSamplingSelection:function(a){a=isNaN(a)?2:0|a;var c=this.state,d=e(c).select("evaluation").sum(),f=d/a;return b.Iterable.iterate(function(a){return a+f},this.random.randomInt(f),a).map(function(a){for(var b=0,d=0;d<c.length;++d)if(b+=c[d].evaluation,b>=a)return c[d];return c[c.length-1]}).toArray()}},"static crossovers":{singlepointCrossover:function(a){f(!Array.isArray(a)||a.length<2,"A two parent array is required.");var b=this.random.randomInt(this.length-1)+1,c=a[0].values,d=a[1].values;return[this.problem.newElement(c.slice(0,b).concat(d.slice(b))),this.problem.newElement(d.slice(0,b).concat(c.slice(b)))]},twopointCrossover:function(a){f(!Array.isArray(a)||a.length<2,"A two parent array is required.");var b=this.random.randomInt(this.length-1)+1,c=this.random.randomInt(this.length-1)+1,d=a[0].values,e=a[1].values;return[this.problem.newElement(d.slice(0,b).concat(e.slice(b,c)).concat(d.slice(c))),this.problem.newElement(e.slice(0,b).concat(d.slice(b,c)).concat(e.slice(c)))]},uniformCrossover:function(a,b){b=isNaN(b)?a.length:0|b;for(var c,d=[],e=this.problem.elementLength(),f=this.random,g=0;b>g;++g){c=[];for(var h=0;e>h;++h)c.push(f.choice(a).values[h]);d.push(this.problem.newElement(c))}return d}},"static mutations":{singlepointUniformMutation:function(a){return a.modification(this.random.randomInt(a.length),this.random.random())},uniformMutation:function(a){return max=isNaN(a)?1/0:+a,function(b){var c=a;b=this.problem.newElement(b.values);do b.values[this.random.randomInt(b.length)]=this.random.random();while(this.random.randomBool(this.mutationRate)&&--c>0);return b}},singlepointBiasedMutation:function(a){var b=this.random,c=b.randomInt(a.length);return a.modification(c,a.values[c]+b.random()-b.random())},recombinationMutation:function(a){var b=a.values.slice(),c=this.random.randomInt(a.length),d=b[c],e=this.random.randomInt(a.length);return c===e&&(e=(e+1)%a.length),b[c]=b[e],b[e]=d,this.problem.newElement(b)}},toString:function(){return(this.constructor.name||"GeneticAlgorithm")+"("+JSON.stringify(this)+")"}}),n.BeamSearch=c(r,{constructor:function(a){r.call(this,a)},successors:function(a){return a.successors()},expansion:function(){var a=[],b=this.successors.bind(this);return this.state.forEach(function(c){a=a.concat(b(c))}),this.onExpand(),a},toString:function(){return(this.constructor.name||"BeamSearch")+"("+JSON.stringify(this)+")"},"static __SERMAT__":{identifier:m.__package__+".BeamSearch",serializer:function(a){return r.__SERMAT__.serializer.call(this,a)}}}),n.SimulatedAnnealing=c(r,{constructor:function(a){r.call(this,a),d(this,a).number("maximumTemperature",{defaultValue:1,coerce:!0}).number("minimumTemperature",{defaultValue:0,coerce:!0}).number("delta",{defaultValue:.01,coerce:!0}).integer("size",{defaultValue:1,coerce:!0}).func("temperature",{defaultValue:this.coolingSchedule.linear})},randomNeighbour:function(a,b){b=isNaN(b)?this.delta:+b;var c=this.random.randomInt(a.values.length),d=a.values[c];return d=this.random.randomBool()?Math.min(1,d+b):Math.max(0,d-b),a.modification(c,d)},acceptance:function(a,b,c){if(c=isNaN(c)?this.temperature():+c,this.problem.compare(a,b)>0)return 1;var d=-Math.abs(b.evaluation-a.evaluation);return Math.max(0,Math.min(1,Math.exp(d/c)))},coolingSchedule:{linear:function(){return(1-Math.max(0,this.step)/this.steps)*(this.maximumTemperature-this.minimumTemperature)+this.minimumTemperature}},update:function(){var a=this,b=this.temperature(),c=this.statistics.stat({key:"acceptance"}),d=this.statistics.stat({key:"temperature"});return d.add(b,this.step),h.all(this.state.map(function(d){var e=a.randomNeighbour(d);return h.when(e.evaluate()).then(function(){var f=a.acceptance(d,e,b);return c.add(f,e),a.random.randomBool(f)?e:d})})).then(function(b){return b.sort(a.problem.compare.bind(a.problem)),a.state=b,a.onUpdate(),a})},toString:function(){return(this.constructor.name||"SimulatedAnnealing")+"("+JSON.stringify(this)+")"}}),n.ParticleSwarm=c(r,{constructor:function(a){r.call(this,a),d(this,a).number("inertia",{defaultValue:1,coerce:!0}).number("localAcceleration",{defaultValue:.5,coerce:!0}).number("globalAcceleration",{defaultValue:.3,coerce:!0})},initiate:function(a){r.prototype.initiate.call(this,a);var b=this,c=this.state.forEach(function(a){var c=a.values.length;a.__velocity__=new Array(c);for(var d=0;c>d;++d)a.__velocity__[d]=b.random.random(-1,1);a.__localBest__=a});return this.onInitiate(),c},nextVelocity:function(a,b){var c=this,d=a.__velocity__,e=a.__localBest__,f=this.random.random()*this.localAcceleration,g=this.random.random()*this.globalAcceleration,h=a.values.map(function(a,h){return d[h]*c.inertia+f*(e.values[h]-a)+g*(b.values[h]-a)});return h},nextElement:function(a,b){var c=this,d=this.nextVelocity(a,b),e=a.values.map(function(a,b){return a+d[b]}),f=this.problem.newElement(e);return h.then(f.evaluate(),function(){return f.__velocity__=d,f.__localBest__=c.problem.compare(a.__localBest__,f)>0?f:a.__localBest__,f})},update:function(){var a=this,b=this.__globalBest__;return b||(b=this.__globalBest__=this.state[0]),h.all(this.state.map(function(c){return a.nextElement(c,b)})).then(function(b){return a.state=b,b.sort(a.problem.compare.bind(a.problem)),a.problem.compare(a.__globalBest__,b[0])>0&&(a.__globalBest__=b[0]),a.onUpdate(),a})},toString:function(){return(this.constructor.name||"ParticleSwarm")+"("+JSON.stringify(this)+")"}}),n.DifferentialEvolution=c(r,{constructor:function(a){r.call(this,a),d(this,a).number("differentialWeight",{coerce:!0,defaultValue:1,minimum:0,maximum:2}).number("crossoverProbability",{coerce:!0,defaultValue:.3,minimum:0,maximum:1}).integer("size",{coerce:!0,defaultValue:100,minimum:4})},expansion:function(){var a=this,b=this.state.map(function(b,c){for(var d=a.random.choices(3,e(a.state).filter(function(a,b){return b!==c})),f=d[0].values,g=d[1].values,h=d[2].values,i=a.random.randomInt(b.length),j=[],k=0;k<b.length;++k)j.push(k===i||a.random.randomBool(a.crossoverProbability)?f[k]+a.differentialWeight*(g[k]-h[k]):b.values[k]);return a.problem.newElement(j)});return this.onExpand(),b},toString:function(){return(this.constructor.name||"DifferentialEvolution")+"("+JSON.stringify(this)+")"},"static __SERMAT__":{identifier:m.__package__+".DifferentialEvolution",serializer:function(a){var b=r.__SERMAT__.serializer.call(this,a),c=b[0];return c.differentialWeight=a.differentialWeight,c.crossoverProbability=a.crossoverProbability,b}}}),n.EvolutionStrategy=c(r,{constructor:function(a){r.call(this,a),d(this,a).number("mutantCount",{coerce:!0,defaultValue:1,minimum:1}).integer("size",{coerce:!0,defaultValue:1,minimum:1})},mutant:function(a){var b=this.random,c=a.values.map(function(a){return a+b.random()-b.random()});return this.problem.newElement(c)},mutants:function(a,b){b=isNaN(b)?this.mutantCount:+b;for(var c=[],d=0;b>d;++d)c.push(this.mutant(a));return c},expansion:function(){var a=this,b=[];return this.state.forEach(function(c){b=b.concat(a.mutants(c))}),this.onExpand(),b},toString:function(){return(this.constructor.name||"EvolutionStrategy")+"("+JSON.stringify(this)+")"}}),n.HarmonySearch=c(r,{constructor:function(a){r.call(this,a),d(this,a).number("harmonyProbability",{coerce:!0,defaultValue:.9,minimum:0,maximum:1}).number("adjustProbability",{coerce:!0,defaultValue:.5,minimum:0,maximum:1}).number("delta",{coerce:!0,defaultValue:.1})},expansion:function(){for(var a=this.state[0],b=new Array(length),c=0;c<a.length;++c)this.random.randomBool(this.harmonyProbability)?(b[c]=this.random.choice(this.state).values[c],this.random.randomBool(this.adjustProbability)&&(b[c]=b[c]+this.random.choice([-1,1])*this.delta)):b[c]=this.random.random();return this.onExpand(),[this.problem.newElement(b)]},toString:function(){return(this.constructor.name||"HarmonySearch")+"("+JSON.stringify(this)+")"}}),n.DistributionEstimation=c(r,{constructor:function(a){r.call(this,a),d(this,a).integer("histogramWidth",{coerce:!0,defaultValue:10,minimum:2})},expansion:function(a){var c=this,d=isNaN(this.expansionRate)?.5:+this.expansionRate,e=this.histograms();return a=isNaN(a)?Math.floor(d*this.size):0|a,b.Iterable.repeat(null,a).map(function(){return c.elementFromHistograms(e)}).toArray()},histograms:function(){return s.histograms(this.state,this.histogramWidth,this.problem.elementLength())},"static histograms":function(a,c,d){var e=a.length,f=b.Iterable.repeat(0,c).toArray(),g=b.Iterable.iterate(function(a){return a.slice()},f,d).toArray();return a.forEach(function(a){a.values.forEach(function(b,d){var e=Math.min(c-1,Math.floor(a.values[d]*c));g[d][e]++})}),g.map(function(a){return a.map(function(a){return a/e})})},elementFromHistograms:function(a){return s.elementFromHistograms(a,this.problem,this.random)},"static elementFromHistograms":function(a,b,c){for(var d,e,f=a.length,g=new Array(f),h=0;f>h;++h){d=a[h],e=c.random();for(var i=0;i<=d.length;++i)if(i===d.length||(e-=d[i])<=0){g[h]=Math.min(1,Math.max(0,(i+c.random())/d.length));break}}return b.newElement(g)},"static histogramProblem":function(a,d,f){d=isNaN(d)?30:Math.max(1,0|d),f=isNaN(f)?10:Math.max(2,0|f);var g=(a.elementLength(),this.elementFromHistograms);return HistogramProblem=c(q,{elementLength:function i(){return i*f},evaluation:function(c){var f=this.mapping(c),i=b.Iterable.repeat(null,d).map(function(){return g(f,a,a.random)});return h.all(e(i).map(function(a){return h.when(a.evaluate())})).then(function(a){return e(a).sum()/a.length})},mapping:function(a){for(var b,c,d=[],g=0;g<a.length;++g)b=a.values.slice(g*f,(g+1)*f),c=e(b).sum(),d[g]=b.map(function(a){return a/c});return d},compare:a.compare}),new HistogramProblem({random:a.random})},toString:function(){return(this.constructor.name||"DistributionEstimation")+"("+JSON.stringify(this)+")"}}));n.GradientDescent=c(r,{constructor:function(a){r.call(this,a),d(this,a).number("delta",{coerce:!0,defaultValue:.01}).integer("size",{coerce:!0,defaultValue:1,minimum:1})},gradient:function(a){return this.gradientFiniteDifferences(a)},rate:function(a){return a=isNaN(a)?this.step:0|a,1/Math.max(1,a)},estimatorWidth:function(a,b){return a=isNaN(a)?this.step:0|a,b=isNaN(b)?this.delta:+b,Math.pow(Math.max(1,a),-1/3)*b},update:function(){var a=this,b=this.rate(this.step);return h.all(this.state.map(function(c){return h.then(a.gradient(c),function(d){var e=d.map(function(a,d){return c.values[d]-a*b});return a.problem.newElement(e)})})).then(function(b){return a.evaluate(b)}).then(function(b){return a.state=b,a.onUpdate(),a})},gradientFiniteDifferences:function(a,b){b=isNaN(b)?this.estimatorWidth():+b;var c=this;return h.all(a.values.map(function(d,e){var f=a.modification(e,d-b),g=a.modification(e,d+b);return h.then(f.evaluate(),function(a){return h.then(g.evaluate(),function(d){var e=c.problem.compare(f,g);return e=0===e?e:e>0?1:-1,(a-d)*e/2/b})})}))},gradientSimultaneousPerturbation:function(){throw new Error("GradientDescent.gradientSimultaneousPerturbation() is not implemented!")},toString:function(){return(this.constructor.name||"GradientDescent")+"("+JSON.stringify(this)+")"}})}o.HelloWorld=c(q,{title:"Hello world",description:"Simple problem where each element is a string, and the optimization goes towards the target string.",constructor:function(a){q.call(this,a),d(this,a).string("target",{coerce:!0,defaultValue:"Hello world!"}),this.__target__=e(target).map(function(a){return a.charCodeAt(0)}).toArray()},elementLength:function(){return target.length},mapping:function(a){return a.rangeMapping([32,254]).map(function(a){return String.fromCharCode(0|a)}).join("")},evaluation:function(a){return a.manhattanDistance(this.__target__,a.rangeMapping([32,254]))},compare:q.prototype.minimization,sufficientElement:function(a){return this.mapping(a)===target}});var t=o.testbed=function(a){var b=isNaN(a.minimumValue)?-1e6:+a.minimumValue,c=isNaN(a.maximumValue)?1e6:+a.maximumValue,d=isNaN(a.length)?2:+a.length;return new q({title:a.title+"",description:a.description+"",elementLength:function(){return d},evaluation:function(){return a.evaluation(this.rangeMapping([b,c]))},compare:a.hasOwnProperty("target")&&a.target!==-1/0?1/0===a.target?q.prototype.maximization:function(b,c){return this.approximation(a.target,b,c)}:q.prototype.minimization,sufficientElement:a.hasOwnProperty("optimumValue")?function(b){return Math.abs(b.evaluation-a.optimumValue)<b.resolution}:q.prototype.sufficientElement})};o.testbeds={Ackley:function(a,b,c,d){return b=isNaN(b)?20:+b,c=isNaN(c)?.2:+c,d=isNaN(d)?2*Math.PI:+d,t({length:a,target:-1/0,minimumValue:-32.768,maximumValue:32.768,optimumValue:0,evaluation:function(a){for(var e,f=0,g=0,h=a.length,i=0;h>i;++i)e=a[i],f+=e*e,g+=Math.cos(d*e);return-b*Math.exp(-c*Math.sqrt(f/h))-Math.exp(g/h)+b+Math.exp(1)}})},crossInTray:function(a){return a=isNaN(a)?-1/0:+a,t({length:2,target:a,minimumValue:-10,maximumValue:10,evaluation:function(a){var b=a[0],c=a[1];return-1e-4*Math.pow(Math.abs(Math.sin(b)*Math.sin(c)*Math.exp(Math.abs(100-Math.sqrt(b*b+c*c)/Math.PI)))+1,.1)}})},Griewank:function(a){return t({length:a,minimumValue:-600,maximumValue:600,optimumValue:0,evaluation:function(a){for(var b,c=0,d=1,e=a.length,f=0;e>f;++f)b=a[f],c+=b*b/4e3,d*=Math.cos(b/Math.sqrt(f+1));return c-d+1}})},Levy:function(a){return t({length:a,target:-1/0,minimumValue:-10,maximumValue:10,optimumValue:0,evaluation:function(a){for(var b,c=0,d=a.length,e=1+(a[0]-1)/4,f=1+(a[d-1]-1)/4,g=1;d-1>g;++g)b=1+(a[g]-1)/4,c+=Math.pow(b-1,2)*(1+10*Math.pow(Math.sin(Math.PI*b+1),2));return Math.pow(Math.sin(Math.PI*e),2)+c+Math.pow(f-1,2)*(1+Math.pow(Math.sin(2*Math.PI*f),2))}})},Michalewicz:function(a,b){return b=isNaN(b)?10:+b,t({length:a,target:-1/0,minimumValue:0,maximumValue:Math.PI,evaluation:function(a){for(var c,d=0,e=a.length,f=0;e>f;++f)c=a[f],d+=Math.sin(c)*Math.pow(Math.sin((f+1)*c*c/Math.PI),2*b);return-d}})},perm0:function(a,b){return a=isNaN(a)?2:Math.min(1,0|a),b=isNaN(b)?0:+b,t({length:a,target:-1/0,minimumValue:-a,maximumValue:+a,optimumValue:0,evaluation:function(c){for(var d,e=0,f=0;a>f;++f){d=0;for(var g=0;a>g;++g)d+=(g+1+b)*(Math.pow(c[g],f+1)-Math.pow(1/(g+1),f+1));e+=d*d}return e}})},Rastrigin:function(a){return t({length:a,target:-1/0,minimumValue:-5.12,maximumValue:5.12,optimumValue:0,evaluation:function(a){for(var b,c=0,d=a.length,e=0;d>e;++e)b=a[e],c+=b*b-10*Math.cos(2*Math.PI*b);return 10*d+c}})},Rosenbrock:function(a,b,c){return b=isNaN(b)?1:+b,c=isNaN(c)?100:+c,t({length:a,target:-1/0,optimumValue:0,evaluation:function(a){for(var d=0,e=1;e<a.length;++e)d+=c*Math.pow(a[e-1]*a[e-1]-a[e],2)+Math.pow(a[e-1]-b,2);return d}})},Schwefel:function(a){return t({length:a,target:-1/0,minimumValue:-500,maximumValue:500,optimumValue:0,evaluation:function(a){for(var b,c=0,d=a.length,e=0;d>e;++e)b=a[e],c+=b*Math.sin(Math.sqrt(Math.abs(b)));return 418.9829*d-c}})},sphere:function(a){return t({length:a,target:-1/0,optimumValue:0,evaluation:function(a){for(var b=0,c=0;c<a.length;++c)b+=a[c]*a[c];return b}})},sumOptimization:function(a,b){return a=isNaN(a)?2:Math.max(1,0|a),b=isNaN(b)?-1/0:+b,t({length:a,target:b,minimumValue:0,maximumValue:1,optimumValue:b===-1/0?0:b===+1/0?a:b,evaluation:function(a){for(var b=0,c=a.length,d=0;c>d;++d)b+=a[d];return b}})}},o.NQueensPuzzle=c(q,{title:"N-queens puzzle",description:"Generalized version of the classic problem of placing 8 chess queens on an 8x8 chessboard so that no two queens attack each other.",constructor:function(a){q.call(this,a),d(this,a).integer("N",{coerce:!0,defaultValue:8}),this.__rowRange__=i.range(this.N).toArray()},elementLength:function(){return this.N},mapping:function(a){return a.setMapping(this.__rowRange__)},evaluation:function(){var a=this.mapping(),b=0;return a.forEach(function(c,d){for(var e=1;d+e<a.length;e++)(a[e]==c+e||a[e]==c-e)&&b++}),b},compare:q.prototype.minimization,sufficientElement:function(){return 0===this.evaluation}}),o.KnapsackProblem=c(q,{title:"Knapsack problem",description:"Given a set of items with a cost and a worth, select a subset  maximizing the worth sum but not exceeding a cost limit.",items:{itemA:{cost:12,worth:4},itemB:{cost:2,worth:2},itemC:{cost:1,worth:2},itemD:{cost:1,worth:1},itemE:{cost:4,worth:10}},constructor:function(a){q.call(this,a),d(this,a).number("limit",{coerce:!0,defaultValue:15}).integer("amount",{coerce:!0,defaultValue:1,minimum:1}).object("items",{ignore:!0})},elementLength:function(){return Object.keys(this.items).length},mapping:function(a){var b={},c=Object.keys(problem.items);return c.sort(),e(a.values).zip(c).forEach(function(a){var c=problem.items[a[1]],d=a[0]*(1+(+c.amount||1))|0;b[a[1]]=d}),b},evaluation:function(a){var b=this.mapping(a),c=0,d=0;return Object.keys(b).forEach(function(a){var e=problem.items[a],f=b[a];c+=e.worth*f,d+=e.cost*f}),d>problem.limit?-c:c},compare:q.prototype.maximization});o.AssociationRuleLearning=c(q,{constructor:function(a){q.call(this,a),d(this,a).object("dataset",{defaultValue:[]}).array("keys")},elementLength:function(){return keys.length},mapping:function(a){var b=this,c=[],d=[];return a.arrayMapping([0,1,2]).forEach(function(a,e){switch(a){case 1:c.push(b.keys[e]);break;case 2:d.push(b.keys[e])}}),{antecedent:c,consequent:d}},keysComply:function(a,b){var c=e(a);return!c.isEmpty()&&c.all(function(a){return!!b[a]})},antecedentComplies:function(a,b){return this.keysComply(a.antecedent,b)},consequentComplies:function(a,b){return this.keysComply(a.consequent,b)},measures:function(a){var b=this,c={},d=0,f=0,g=0,h=0,i=this.mapping(a);return e(this.dataset).forEach(function(a){b.antecedentComplies(i,a)?(++f,b.consequentComplies(i,a)&&(++g,++h)):b.consequentComplies(i,a)&&++g,++d}),c.antecedentCount=f,c.consequentCount=g,c.ruleCount=h,c.antecedentSupport=d>0?f/d:0,c.consequentSupport=d>0?g/d:0,c.ruleSupport=d>0?h/d:0,c.confidence=f>0?h/f:0,c.lift=c.consequentSupport>0?c.confidence/c.consequentSupport:0,c.conviction=c.consequentSupport>0&&c.confidence<1?(1-c.consequentSupport)/(1-c.confidence):0,c.leverage=c.ruleSupport-c.antecedentSupport*c.consequentSupport,c},evaluation:function(a){return a.__measures__||(a.__measures__=this.measures(a)),a.__measures__.confidence}});return[p].forEach(function(a){a.__SERMAT__.identifier=m.__package__+"."+a.__SERMAT__.identifier,m.__SERMAT__.include.push(a)}),m});
//# sourceMappingURL=inveniemus.min.js.map